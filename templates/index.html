<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTC Price Prediction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .card {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 10px;
            margin-bottom: 1.5rem;
        }
        .price-display {
            font-size: 2.5rem;
            font-weight: bold;
            color: #28a745;
        }
        .prediction-item {
            padding: 0.5rem;
            border-left: 4px solid #007bff;
            margin-bottom: 0.5rem;
            background-color: #f8f9fa;
        }
        .positive {
            color: #28a745;
        }
        .negative {
            color: #dc3545;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-4">ðŸ’° BTC Price Prediction</h1>
                    <p class="lead">Real-time Bitcoin price analysis and future predictions using machine learning</p>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-light btn-lg" onclick="retrainModel()">ðŸ”„ Retrain Model</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Current Price Card -->
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body text-center">
                        <h5 class="card-title">Current BTC Price</h5>
                        <div class="price-display">${{ "%.2f"|format(current_price) }}</div>
                        <p class="card-text {% if price_change >= 0 %}positive{% else %}negative{% endif %}">
                            {{ "%.2f"|format(price_change) }}%
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body text-center">
                        <h5 class="card-title">24h Volume</h5>
                        <div class="price-display" style="font-size: 1.8rem;">
                            {{ "%.0f"|format(volume) }}
                        </div>
                        <p class="card-text">BTC</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body text-center">
                        <h5 class="card-title">Data Points</h5>
                        <div class="price-display" style="font-size: 1.8rem;">
                            {{ data_count }}
                        </div>
                        <p class="card-text">Historical candles</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Price Chart & Predictions</h5>
                    </div>
                    <div class="card-body">
                        {% if plot_url %}
                            <img src="data:image/png;base64,{{ plot_url }}" class="img-fluid" alt="Price Prediction Chart">
                        {% else %}
                            <p class="text-center text-muted">Loading chart...</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Predictions -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Next 10 Period Predictions</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            {% if predictions %}
                                {% for i, pred in enumerate(predictions) %}
                                    <div class="col-md-6 col-lg-4">
                                        <div class="prediction-item">
                                            <strong>Period {{ i + 1 }}:</strong> 
                                            <span class="float-end">${{ "%.2f"|format(pred) }}</span>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <div class="col-12">
                                    <p class="text-center text-muted">No predictions available</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h6>About this Model</h6>
                        <ul>
                            <li>Uses 2,000 BTC/USDT 1-hour candles from Binance</li>
                            <li>Linear Regression model trained on historical price patterns</li>
                            <li>Features include: OHLC prices, volume, price changes, moving averages</li>
                            <li>Predicts the next 10 periods (hours)</li>
                            <li><strong>Disclaimer:</strong> This is for educational purposes only. Cryptocurrency trading involves risk.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-3 mt-5">
        <div class="container">
            <p class="mb-0">BTC Price Prediction Service | Data from Binance | Built with Python & Flask</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function retrainModel() {
            fetch('/retrain')
                .then(response => response.json())
                .then(data => {
                    alert('Model retrained successfully!');
                    location.reload();
                })
                .catch(error => {
                    alert('Error retraining model: ' + error);
                });
        }

        // Auto-refresh every 5 minutes
        setInterval(() => {
            location.reload();
        }, 300000);
    </script>
</body>
</html>